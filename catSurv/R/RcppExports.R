# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Probability of Responses to a Question Item or the Left-Cumulative Probability of Responses
#'
#' Calculates the probability of specific responses or the left-cumulative probability of responses to \code{item} conditioned on a respondent's ability (\eqn{\theta}).  
#'
#' @param catObj An object of class \code{Cat}
#' @param theta A numeric or an integer indicating the value for \eqn{\theta_j}
#' @param item An integer indicating the index of the question item
#'
#' @return When the argument \code{catObj} is an \code{ltm} model, the function \code{probabilty} returns a numeric vector of length one representing the probabilty of observing a non-zero response.
#'
#'When the argument \code{catObj} is an \code{tpm} model, the function \code{probabilty} returns a numeric vector of length one representing the probabilty of observing a non-zero response.
#'
#' When the argument \code{catObj} is a \code{grm} model, the function \code{probabilty} returns a numeric vector of length k+1, where k is the number of possible responses. The first element will always be zero and the kth element will always be one. The middle elements are the cumulative probability of observing response k or lower.
#'
#'  When the argument \code{catObj} is a \code{gpcm} model, the function \code{probabilty} returns a numeric vector of length k, where k is the number of possible responses. Each number represents are the probability of observing response k.
#'
#' @details 
#'  For the \code{ltm} model, the probability of non-zero response for respondent \eqn{j} on item \eqn{i} is
#'  
#'  \deqn{Pr(y_{ij}=1|\theta_j)=\frac{\exp(a_i + b_i \theta_j)}{1+\exp(a_i + b_i \theta_j)}}
#'
#'  where \eqn{\theta_j} is respondent \eqn{j} 's position on the latent scale of interest, \eqn{a_i} is item \eqn{i} 's discrimination parameter,
#'  and \eqn{b_i} is item \eqn{i} 's difficulty parameter. 
#'  
#'  For the \code{tpm} model, the probability of non-zero response for respondent \eqn{j} on item \eqn{i} is
#'  
#'  \deqn{Pr(y_{ij}=1|\theta_j)=c_i+(1-c_i)\frac{\exp(a_i + b_i \theta_j)}{1+\exp(a_i + b_i \theta_j)}}
#'
#'  where \eqn{\theta_j} is respondent \eqn{j} 's position on the latent scale of interest, \eqn{a_i} is item \eqn{i} 's discrimination parameter,
#'  \eqn{b_i} is item \eqn{i} 's difficulty parameter, and \eqn{c_i} is item \eqn{i} 's guessing parameter. 
#'  
#'  For the \code{grm} model, the probability of a response in category \eqn{k} \strong{or lower} for respondent \eqn{j} on item \eqn{i} is
#' 
#'  \deqn{Pr(y_{ij} <  k|\theta_j)=\frac{\exp(\alpha_{ik} - \beta_i \theta_{ij})}{1+\exp(\alpha_{ik} - \beta_i \theta_{ij})}}{Pr(y_ij < k | \theta_j) = (exp(\alpha_ik - \beta_i \theta_ij))/(1 + exp(\alpha_ik - \beta_i \theta_ij))}
#'
#'  where \eqn{\theta_j} is respondent \eqn{j} 's position on the latent scale of interest, \eqn{\alpha_ik} the \eqn{k}-th element of item \eqn{i} 's difficulty parameter, 
#'  \eqn{\beta_i} is discrimination parameter vector for item \eqn{i}. Notice the inequality on the left side and the absence of guessing parameters.
#'
#'  For the \code{gpcm} model, the probability of a response in category \eqn{k} for respondent \eqn{j} on item \eqn{i} is
#' 
#'  \deqn{Pr(y_{ij} =  k|\theta_j)=\frac{\exp(\sum_{t=1}^k \alpha_{i} [\theta_j - (\beta_i - \tau_{it})])}
#'  {\sum_{r=1}^{K_i}\exp(\sum_{t=1}^{r} \alpha_{i} [\theta_j - (\beta_i - \tau_{it}) )}}
#'  
#'  
#'  where \eqn{\theta_j} is respondent \eqn{j} 's position on the latent scale of interest, \eqn{\alpha_i} is the discrimination parameter for item \eqn{i},
#'  \eqn{\beta_i} is the difficulty parameter for item \eqn{i}, and \eqn{\tau_{it}} is the category \eqn{t} threshold parameter for item \eqn{i}, with \eqn{k = 1,...,K_i} response options
#'  for item \eqn{i}.  For identification purposes \eqn{\tau_{i0} = 0} and \eqn{\sum_{t=1}^1 \alpha_{i} [\theta_j - (\beta_i - \tau_{it})] = 0}.
#'
#'@examples
#'\dontrun{
#'## Probability for Cat object of the ltm model
#'data(npi)
#'ltm_cat <- ltmCat(npi)
#'probability(ltm_cat, theta = 1, item = 1)
#'
#'## Probability for Cat object of the tpm model
#'data(polknow)
#'tpm_cat <- tpmCat(polknow)
#'probability(tpm_cat, theta = 1, item = 1)
#'
#'## Probability for Cat object of the grm model
#'data(nfc)
#'grm_cat <- grmCat(nfc)
#'probability(grm_cat, theta = 1, item = 1)
#'}
#'  
#' @seealso \code{\link{Cat}} for information on the item parameters: discrimination, difficulty, and guessing.
#'  
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#' 
#' @references 
#' Baker, Frank B. and Seock-Ho Kim. 2004. Item Response Theory: Parameter Estimation Techniques. New York: Marcel Dekker.
#' 
#' Choi, Seung W. and Richard J. Swartz. 2009. “Comparison of CAT Item Selection Criteria for Polytomous Items.” Applied Psychological Measurement 33(6):419–440.
#' 
#' Muraki, Eiji. 1992. "A generalized partial credit model: Application of an EM algorithm." ETS Research Report Series 1992(1): 1-30.
#' 
#' van der Linden, Wim J. 1998. “Bayesian Item Selection Criteria for Adaptive Testing.” Psychometrika 63(2):201–216.
#' 
#'  
#' @export
probability <- function(catObj, theta, item) {
    .Call('catSurv_probability', PACKAGE = 'catSurv', catObj, theta, item)
}

#' Likelihood of the Specified Response Set
#'
#' Calculates the likelihood of a respondent, with ability parameter \eqn{\theta}, having offered the specific set of responses stored in the \code{Cat} objects \code{answers} slot, conditional on the item-level parameters.
#'
#' @param catObj An object of class \code{Cat}
#' @param theta A numeric or an integer indicating the value for \eqn{\theta_j} 
#' 
#' @return The function \code{likelihood} returns a numeric value of the likelihood of the respondent having offered the provided response profile.
#'
#' @details
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#' 
#' @references 
#' 
#'@examples
#'\dontrun{
#'## Create Cat object, store example answers, and calculate
#'## likelihood at theta = 1
#'
#'## Likelihood for Cat object of the ltm model
#'data(npi)
#'ltm_cat <- ltmCat(npi)
#'setAnswers(ltm_cat) <- c(1,0,1,0,1, rep(NA, 35))
#'likelihood(ltm_cat, theta = 1)
#'
#'## Likelihood for Cat object of the tpm model
#'data(polknow)
#'tpm_cat <- tpmCat(polknow)
#'setAnswers(tpm_cat) <- c(1,0,1,0, rep(NA, 35))
#'likelihood(tpm_cat, theta = 1)
#'
#'## Likelihood for Cat object of the grm model
#'data(nfc)
#'grm_cat <- grmCat(nfc)
#'setAnswers(grm_cat) <- c(1,3,4,5, rep(NA, 13))
#'likelihood(grm_cat, theta = 1)
#'}
#'
#'
#' @seealso \code{\link{probability}} for probability of responses to a given question item
#'  
#' @export
likelihood <- function(catObj, theta) {
    .Call('catSurv_likelihood', PACKAGE = 'catSurv', catObj, theta)
}

#' Prior Value
#'
#' Calculates the density at \code{x} of either the normal, Student's t, or uniform distribution.
#'
#' @param x A numeric value at which to evaluate the prior
#' @param dist A string indicating the distribution (slot \code{priorName} of \code{Cat} object)
#' @param params A length two numeric vector indicating the parameters of the distribution (slot \code{priorParams} of \code{Cat} object)
#' 
#' @return The function \code{prior} returns a numeric consisting of prior value, \eqn{\pi(x)}, given the value \code{x}.
#'
#' @details The \code{dist} argument needs to be either "UNIFORM", "NORMAL", or "STUDENT_T".
#' 
#' When \code{dist} is "NORMAL", the first element of \code{params} is the mean, 
#' the second element is the standard deviation.
#' 
#' When \code{dist} is "STUDENT_T", the first 
#' element of \code{params} is the non-centrality parameters and the second is degrees of freedom.  
#' 
#' When \code{dist} is "UNIFORM", the elements of \code{params} are the lower and upper bounds,
#' of the interval, respectively.  Note that the "UNIFORM" is only applicable for the "EAP" estimation method.   
#' 
#' @examples
#' \dontrun{
#'## Prior calculation using Cat object of the ltm model
#'## specifying different distributions
#'data(npi)
#'cat <- ltmCat(npi)
#'
#'cat@priorName <- "NORMAL"
#'cat@priorParams <- c(0, 1) ## Parameters are mean and standard deviation
#'prior(x = 1, cat@priorName, cat@priorParams)
#'
#'cat@priorName <- "STUDENT_T"
#'cat@priorParams <- c(1, 3) ## Parameters are non-centrality param and degrees of freedom
#'prior(x = 1, cat@priorName, cat@priorParams)
#'
#'cat@priorName <- "UNIFORM"
#'cat@priorParams <- c(-1, 1) ## Parameters are lower bound and upper bound of interval
#'prior(x = 1, cat@priorName, cat@priorParams)
#'}
#'
#' @seealso
#' 
#' \code{\link{Cat}} for information on \code{priorName} and \code{priorParams} slots
#'  
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#' 
#' This function uses Boost C++ source libraries for the uniform and Student's t
#' distributions and calls \code{dnorm4} written in C which is identical to that 
#' of \code{dnorm} in \code{R}.
#' 
#'  
#'  
#' @export
prior <- function(x, dist, params) {
    .Call('catSurv_prior', PACKAGE = 'catSurv', x, dist, params)
}

#' The First Derivative of the Log-Likelihood
#' 
#' Calculates either the first derivative of the log-likelihood or the first derivative
#' of the log-posterior evaluated at point \eqn{\theta}.
#' 
#' @param catObj An object of class \code{Cat}
#' @param theta A numeric or an integer indicating the value for \eqn{\theta_j}
#' @param use_prior A logical indicating whether to use the prior parameters in estimation
#' 
#' @return The function \code{dLL} returns a numeric of the derivative of the log-likelihood (or log-posterior) given a respondent's answer profile.
#' 
#' @details
#' When \code{usePrior = FALSE}, the function \code{dLL} evaluates the first derivative of the log-likelihood at point \eqn{\theta}.  
#' 
#' When \code{usePrior = TRUE}, the function \code{dLL} evaluates the first derivative of the log-posterior at point \eqn{\theta}. 
#' 
#' The function \code{dLL} is only available when using the normal prior distribution.
#' 
#' @examples
#' \dontrun{
#'## Create Cat object, store example answers, and calculate
#'## first derivative of log-likelihood at theta = 1
#'
#'## dLL for Cat object of the ltm model
#'data(npi)
#'ltm_cat <- ltmCat(npi)
#'setAnswers(ltm_cat) <- c(1,0,1,0,1, rep(NA, 35))
#'dLL(ltm_cat, theta = 1)
#'
#'## dLL for Cat object of the tpm model
#'data(polknow)
#'tpm_cat <- tpmCat(polknow)
#'setAnswers(tpm_cat) <- c(1,0,1,0, rep(NA, 35))
#'dLL(tpm_cat, theta = 1)
#'
#'## dLL for Cat object of the grm model
#'data(nfc)
#'grm_cat <- grmCat(nfc)
#'setAnswers(grm_cat) <- c(1,3,4,5, rep(NA, 13))
#'dLL(grm_cat, theta = 1)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#' 
#' @seealso
#' 
#' \code{\link{Cat}} for specifying priors and prior parameteres
#' \code{\link{prior}} for more information on available priors
#'  
#' @export
dLL <- function(catObj, theta, use_prior) {
    .Call('catSurv_dLL', PACKAGE = 'catSurv', catObj, theta, use_prior)
}

#' The Second Derivative of the Log-Likelihood
#' 
#' Calculates either the second derivative of the log-likelihood or the second derivative
#' of the log-posterior evaluated at point \eqn{\theta}.
#' 
#' @param catObj An object of class \code{Cat}
#' @param theta A numeric or an integer indicating the value for \eqn{\theta_j}
#' @param use_prior A logical indicating whether to use the prior parameters in estimation
#' 
#' @return The function \code{d2LL} returns a numeric of the second derivative of the log-likelihood (or log-posterior) given a respondent's answer profile.
#' 
#' @details
#' When \code{usePrior = FALSE}, the function \code{d2LL} evaluates the second derivative of the log-likelihood at point \eqn{\theta}.  
#' 
#' When \code{usePrior = TRUE}, the function \code{d2LL} evaluates the second derivative of the log-posterior at point \eqn{\theta}. 
#' 
#' The function \code{d2LL} is only available when using the normal prior distribution.
#' 
#' @examples
#' \dontrun{
#'## Create Cat object, store example answers, and calculate
#'## second derivative of log-likelihood at theta = 1
#'
#'## d2LL for Cat object of the ltm model
#'data(npi)
#'ltm_cat <- ltmCat(npi)
#'setAnswers(ltm_cat) <- c(1,0,1,0,1, rep(NA, 35))
#'d2LL(ltm_cat, theta = 1)
#'
#'## d2LL for Cat object of the tpm model
#'data(polknow)
#'tpm_cat <- tpmCat(polknow)
#'setAnswers(tpm_cat) <- c(1,0,1,0, rep(NA, 35))
#'d2LL(tpm_cat, theta = 1)
#'
#'## d2LL for Cat object of the grm model
#'data(nfc)
#'grm_cat <- grmCat(nfc)
#'setAnswers(grm_cat) <- c(1,3,4,5, rep(NA, 13))
#'d2LL(grm_cat, theta = 1)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#' 
#' @seealso
#' \code{\link{Cat}} for specifying priors and prior parameteres
#' \code{\link{prior}} for more information on available priors
#' \cdoe{\link{dLL}} for calculation of first derivative of log-likelihood
#' 
#' @export
d2LL <- function(catObj, theta, use_prior) {
    .Call('catSurv_d2LL', PACKAGE = 'catSurv', catObj, theta, use_prior)
}

#' Estimate of the Respondent's Ability Parameter
#'
#' Estimates the expected value of the ability parameter \eqn{\theta}, conditioned on the observed answers, prior, and the item parameters.
#'
#' @param catObj An object of class \code{Cat}
#'
#' @return The function \code{estimateTheta} returns a numeric consisting of the expected value of the respondent's ability parameter.
#'
#' @details
#' 
#' Estimation approach is specified in \code{estimation} slot of \code{Cat} object.
#' 
#' The expected a posteriori approach is used when \code{estimation} slot is "EAP".
#' 
#' The modal a posteriori approach is used when \code{estimation} slot is "MAP".  This method is only available using the normal prior distribution.
#' 
#' The maximum likelihood approach is used when \code{estimation} slot is "MLE".  When the likelihood is undefined,
#' the MAP or EAP method will be used, determined by what is specified in the \code{estimationDefault} slot in \code{Cat} object.
#' 
#' The weighted maximum likelihood approach is used when \code{estimation} slot is "WLE". Estimating \eqn{\theta} requires root finding with the ``Brent'' method in the \code{gsl} library.
#' 
#' @examples
#' \dontrun{
#'## Create Cat object, store example answers, and estimate ability parameter
#'## using different estimation procedures
#'
#'## theta estimates for Cat object of the ltm model
#'data(npi)
#'ltm_cat <- ltmCat(npi)
#'setAnswers(ltm_cat) <- c(1,0,1,0,1, rep(NA, 35))
#'setEstimation(ltm_cat) <- "EAP"
#'estimateTheta(ltm_cat)
#'
#'setEstimation(ltm_cat) <- "MAP"
#'estimateTheta(ltm_cat)
#'
#'setEstimation(ltm_cat) <- "MLE"
#'estimateTheta(ltm_cat)
#'
#'setEstimation(ltm_cat) <- "WLE"
#'estimateTheta(ltm_cat)
#'
#'## theta estimates for Cat object of the tpm model
#'data(polknow)
#'tpm_cat <- tpmCat(polknow)
#'setAnswers(tpm_cat) <- c(1,0,1,0, rep(NA, 35))
#'setEstimation(tpm_cat) <- "EAP"
#'estimateTheta(tpm_cat)
#'
#'setEstimation(tpm_cat) <- "MAP"
#'estimateTheta(tpm_cat)
#'
#'setEstimation(tpm_cat) <- "MLE"
#'estimateTheta(tpm_cat)
#'
#'setEstimation(tpm_cat) <- "WLE"
#'estimateTheta(tpm_cat)
#'
#'## theta estimates for Cat object of the grm model
#'data(nfc)
#'grm_cat <- grmCat(nfc)
#'setAnswers(grm_cat) <- c(1,3,4,5, rep(NA, 13))
#'setEstimation(grm_cat) <- "EAP"
#'estimateTheta(grm_cat)
#'
#'setEstimation(grm_cat) <- "MAP"
#'estimateTheta(grm_cat)
#'
#'setEstimation(grm_cat) <- "MLE"
#'estimateTheta(grm_cat)
#'
#'setEstimation(grm_cat) <- "WLE"
#'estimateTheta(grm_cat)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#' 
#' @seealso
#' 
#' \code{\link{Cat}} for information on the \code{estimation} slot 
#'  
#' @export
estimateTheta <- function(catObj) {
    .Call('catSurv_estimateTheta', PACKAGE = 'catSurv', catObj)
}

#' Observed Information
#'
#' Calculates the observed information of the likelihood of a respondent's ability \eqn{\theta} for a given \code{item}.
#'
#' @param catObj An object of class \code{Cat}
#' @param theta A numeric or an integer indicating the value for \eqn{\theta_j}
#' @param item An integer indicating the index of the question item
#'
#' @return The function \code{obsInf} returns a numeric value of the observed information of the likelihood, given \eqn{\theta}, for a given question item.
#' 
#' @details The observed information is equivalent to the negative second derivative of the log-likelihood.
#' This function should never be called when the respondent has answered no questions.
#'   
#' @examples
#' \dontrun{
#'## Create Cat object, store example answers, and calculate observed information
#'for an ability parameter of 1 for item 10
#'
#'## observed information for Cat object of the ltm model
#'data(npi)
#'ltm_cat <- ltmCat(npi)
#'setAnswers(ltm_cat) <- c(1,0,1,0,1, rep(NA, 35))
#'obsInf(ltm_cat, theta = 1, item = 10)
#'
#'## observed information for Cat object of the tpm model
#'data(polknow)
#'tpm_cat <- tpmCat(polknow)
#'setAnswers(tpm_cat) <- c(1,0,1,0, rep(NA, 35))
#'obsInf(tpm_cat, theta = 1, item = 10)
#'
#'## observed information for Cat object of the grm model
#'data(nfc)
#'grm_cat <- grmCat(nfc)
#'setAnswers(grm_cat) <- c(1,3,4,5, rep(NA, 13))
#'obsInf(grm_cat, theta = 1, item = 10)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#'
#' @seealso
#' 
#' \code{\link{estimateTheta}} for calculation of \eqn{\theta}
#' 
#' \code{\link{expectedObsInf}} for further application of observed information
#'  
#' @export
obsInf <- function(catObj, theta, item) {
    .Call('catSurv_obsInf', PACKAGE = 'catSurv', catObj, theta, item)
}

#' Expected Observed Information
#'
#' Calculates the expected information, which is the observed information attained from a specific response set times the probability of that profile occurring.
#'
#' @param catObj An object of class \code{Cat}
#' @param item An integer indicating the index of the question item
#' 
#' @return The function returns a numeric value of the expected information 
#' 
#' @details
#' 
#' @examples
#' \dontrun{
#'## Prior calculation using Cat object of the ltm model
#'## specifying different distributions
#'data(npi)
#'cat <- ltmCat(npi)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#'
#' @seealso \code{\link{estimateTheta}} for calculation of \eqn{\theta} and 
#'   \code{\link{obsInf}} for observed information calculation
#'  
#' @export
expectedObsInf <- function(catObj, item) {
    .Call('catSurv_expectedObsInf', PACKAGE = 'catSurv', catObj, item)
}

#' Fisher's Information
#'
#' Calculates the expected value of the observed information of the likelihood evaluated at the input value \eqn{\theta}
#'
#' @param catObj An object of class \code{Cat}
#' @param theta A numeric or an integer indicating the potential value for \eqn{\theta_j}
#' @param item An integer indicating the index of the question item
#'
#' @return The function returns a numeric of the expected value of the observed information
#' 
#' @details For the dichotomous case, this is equivalent to the observed information.  
#' 
#' @examples
#' \dontrun{
#'## Prior calculation using Cat object of the ltm model
#'## specifying different distributions
#'data(npi)
#'cat <- ltmCat(npi)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#'
#' @seealso
#' 
#' \code{\link{obsInf}} for observed information calculation
#' 
#' \code{\link{fisherTestInfo}} for further application of Fisher's information
#'  
#' @export
fisherInf <- function(catObj, theta, item) {
    .Call('catSurv_fisherInf', PACKAGE = 'catSurv', catObj, theta, item)
}

#' Fisher's Test Information
#'
#' Calculates the total information gained for a respondent \eqn{j} for all answered items, conditioned on \eqn{theta}.
#'
#' @param catObj An object of class \code{Cat}
#' 
#' @return The total information gained for a respondent, given a specific answer set and a value of \eqn{theta}.
#' 
#' @details
#' 
#' @examples
#' \dontrun{
#'## Prior calculation using Cat object of the ltm model
#'## specifying different distributions
#'data(npi)
#'cat <- ltmCat(npi)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#'
#' @seealso \code{\link{fisherInf}} for calculation of Fisher's information for an individual question item
#'  
#' @export
fisherTestInfo <- function(catObj) {
    .Call('catSurv_fisherTestInfo', PACKAGE = 'catSurv', catObj)
}

#' Standard Error of Ability Parameter Estimate
#'
#' Estimates the standard error for a respondent's ability parameter estimate.
#'
#' @param catObj An object of class \code{Cat}
#'
#' @return The function \code{estimateSE} returns a numeric for the standard error for \eqn{\theta}.
#'
#' @details 
#'   The EAP estimator:
#'   The MAP estimator (This is implemented only for the normal prior.)
#'   The MLE  estimator (When MLE can't be calculated... estimationDefault)
#'   The WLE estimator (Brent method)
#'   
#' @examples
#' \dontrun{
#'## Prior calculation using Cat object of the ltm model
#'## specifying different distributions
#'data(npi)
#'cat <- ltmCat(npi)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#'
#' @seealso \code{\link{estimateTheta}} for estimation of \eqn{\theta}
#'  
#' @export
estimateSE <- function(catObj) {
    .Call('catSurv_estimateSE', PACKAGE = 'catSurv', catObj)
}

#' Expected Posterior Variance
#'
#' Estimates the expected posterior variance for a respondent's estimated ability parameter for an item yet to be answered based on a respondent's ability parameter estimate from the already-answered items
#'
#' @param catObj An object of class \code{Cat}
#' @param item An integer indicating the index of the question item
#'
#' @return A numeric value indicating a respondent's expected posterior variance for a yet to be asked question item
#'
#' @details 
#' 
#' @examples
#' \dontrun{
#'## Prior calculation using Cat object of the ltm model
#'## specifying different distributions
#'data(npi)
#'cat <- ltmCat(npi)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#'
#' 
#' @seealso
#' 
#' \code{\link{probability}} for probability of responses to individual question item
#' 
#' \code{\link{estimateTheta}} for estimation of \eqn{\theta}
#'  
#' 
#' @export
expectedPV <- function(catObj, item) {
    .Call('catSurv_expectedPV', PACKAGE = 'catSurv', catObj, item)
}

#' Select the next item in the question set
#'
#' Selects the next item in the question set based on the specified method
#' 
#' @param catObj An object of class \code{Cat}
#'
#' @return It returns a list with two elements: 
#' (1) A dataframe containing a column with the indexes of unasked questions and a column with the values (calculated by the specified selection method) for those items, 
#' and (2) a numeric containing the index of the question that should be asked next.
#'
#' @details The EPV method:
#'   
#'   This function takes in a \code{Cat} object from \code{R} and constructs the \code{C++} representation. It then calculates the expected posterior variance for each unanswered item. 
#'   
#'   The function returns a list with the following two elements:
#'   \code{all.estimates}: A data fame with two columns. The first column ("questions") should be the index of the question items and the second column ("EPV") of the expected posterior variance for that corresponding item. 
#'   There are as many rows in this data frame as there are unsanswered questions in the battery.
#'   \code{next.item}: A numeric vector with the index of the item with the lowest EPV value.
#'   
#'   See \code{expectedPV} for mathematical details.
#'   
#'   The MFI method:
#'   
#'   This function takes a \code{Cat} object and calculates Fisher's information for each unanswered item. It then finds the one item that maximizes Fisher's information, based on the respondent's position on the latent trait from the answered items. 
#'   
#'   The function returns a list with the following two elements:
#'   \code{all.estimates}: A data fame with two columns. The first column ("questions") should be the index of the question items and the second column of the expected posterior variance for that corresponding item.
#'   There are as many rows in this data frame as there are unsanswered questions in the battery.
#'   \code{next.item}: A numeric vector with the index of the item with the highest Fisher's information value.
#'
#'   See \code{fisherInf} for mathematical details.
#'   
#'   The MLWI method:
#'   
#'   This function calculates the likelihood for each value of X at the input value of \eqn{\theta}.
#'   Evaluates the integral over a measure of the plausibility of possible values of \eqn{\theta} by weighting Fisher's information with the likelihood function and selecting the next question according to:
#'  
#'   
#'   The MPWI method:
#'   
#'   This function calculates the likelihood for each value of X at the input value of \eqn{\theta}.
#'   Evaluates the integral over a measure of the plausibility of possible values of \eqn{\theta} by weighting Fisher's information with the likelihood function and selecting the next question according to:
#'
#' 
#'   The MEI method:
#'   
#'   This function estimates the expected observed information for a respondent’s estimated
#'   position on the latent trait on an unanswered item based on the
#'   respondent’s position on the latent trait calculated from answered items.
#'   
#'   The output should be a single numeric value.
#'
#'   Binary details:
#'
#'
#'   Categorical details:
#'   
#'   
#'   The KL method:
#'   
#'   This procedure chooses the next item with the largest KL value.
#'   
#'   See \code{expectedKL}, \code{likelihoodKL}, and/or \code{posteriorKL} for mathematical details.
#'   
#'   The MFII method:
#'   
#'   This approach chooses items based on the Fisher's information in an interval near the current estimate \eqn{\hat{\theta}}.
#'   
#'   \deqn{FII_i = \int^{\hat{\theta}+\delta}_{\hat{\theta}-\delta}I_i(\theta_0) d\theta_0}{FII_i = \int^{\hat{\theta} + \delta}_{\hat{\theta} - \delta} I_i(\theta_0) d\theta_0}
#'
#'   where \deqn{\delta = z(I(\hat{\theta}))^{-1/2}}{\delta = z(I(\hat{\theta}))^{-1/2}},  \eqn{I(\hat{\theta})} is the test information for respondent \eqn{j} evaluated at \eqn{\hat{\theta}},  \deqn{I_i(\cdot)}{I_i(.)} is the Fisher's information for item \eqn{i}, and \eqn{z} is a user specified z-value.
#'   
#'   The random method:
#'   
#'   This routine serves as a baseline for comparison. The routine simply selects an unanswered question at random.
#'
#' @examples
#' \dontrun{
#'## Prior calculation using Cat object of the ltm model
#'## specifying different distributions
#'data(npi)
#'cat <- ltmCat(npi)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#' 
#' @seealso \code{\link{estimateTheta}} for calculation of \eqn{\theta};  
#'   \code{\link{obsInf}} for observed information calculation;
#'   \code{\link{fisherTestInfo}} for Fisher's information calculation;
#'   \code{\link{expctedKL}} for expected Kullback-Leibeler calculation;
#'   \code{\link{likelihoodKL}} for likelihood Kullback-Leibeler calculation;  
#'   \code{\link{posteriorKL}} for posterior Kullback-Leibeler calculation; 
#'  
#' @export
selectItem <- function(catObj) {
    .Call('catSurv_selectItem', PACKAGE = 'catSurv', catObj)
}

#' Expected Kullback-Leibeler information
#'
#' Calculates the expected Kullback-Leibeler information for an individual question item
#' 
#' @return The function returns a numeric indicating the KL information for the desired item, given the current answer profile and ability parameter estimate
#' 
#' @param catObj An object of class \code{Cat}
#' @param item An integer indicating the index of the question item
#'
#' @details 
#'  Binary details (Due to the conditional independence assumption, we only need to calculate the expected value for potential new items.)
#' 
#' @examples
#' \dontrun{
#'## Prior calculation using Cat object of the ltm model
#'## specifying different distributions
#'data(npi)
#'cat <- ltmCat(npi)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#' 
#' @seealso \code{\link{likelihoodKL}} and/or \code{\link{posteriorKL}} for alternative KL methods
#'
#' @export
expectedKL <- function(catObj, item) {
    .Call('catSurv_expectedKL', PACKAGE = 'catSurv', catObj, item)
}

#' Expected Kullback-Leibeler information, weighted by the likelihood
#'
#' Calculate the expected Kullback-Leibeler information, weighted by the likelihood
#' 
#' @return A value indicating the LKL information for the desired item, given the current answer profile and ability estimate.
#' 
#' @param catObj An object of class \code{Cat}
#' @param item An integer indicating the index of the question item
#'
#' @details The LKL calculation follows the same procedure as \code{expectedKL}, except it requires weighting the different potential values of \eqn{\theta_0} by the likelihood.
#'  Thus, the equation is
#'
#'  Binary details:
#'  
#'  Due to the conditional independence assumption, we only need to calculate the expected value for potential new items.
#'  
#' @examples
#' \dontrun{
#'## Prior calculation using Cat object of the ltm model
#'## specifying different distributions
#'data(npi)
#'cat <- ltmCat(npi)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#' 
#'  
#' @seealso \code{\link{expectedKL}} and/or \code{\link{posteriorKL}} for alternative KL methods 
#'  
#' @export
likelihoodKL <- function(catObj, item) {
    .Call('catSurv_likelihoodKL', PACKAGE = 'catSurv', catObj, item)
}

#' Expected Kullback-Leibeler information, weighted by the posterior
#'
#' Calculate the expected Kullback-Leibeler information, weighted by the posterior
#' 
#' @return A value indicating the posterior KL information for the desired item, given the current answer profile and ability estimate.
#' 
#' @param catObj An object of class \code{Cat}
#' @param item An integer indicating the index of the question item
#'
#' @details We will follow the same procedure as \code{expectedKL}, except we will weight the different potential values of \eqn{\theta_0} by the posterior.
#'
#'Due to the conditional independence assumption, we only need to calculate the expected value for potential new items.
#'
#' @examples
#' \dontrun{
#'## Prior calculation using Cat object of the ltm model
#'## specifying different distributions
#'data(npi)
#'cat <- ltmCat(npi)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#' 
#' @seealso \code{\link{likelihoodKL}} and/or \code{\link{expectedKL}} for alternative KL methods
#' 
#' @export
posteriorKL <- function(catObj, item) {
    .Call('catSurv_posteriorKL', PACKAGE = 'catSurv', catObj, item)
}

#' Look Ahead to Select Next Item
#'
#' Selects the next item that would be asked for all possible response options to the question the respondent is currently answering
#'
#' @param catObj  An object of class \code{Cat}
#' @param item A numeric indicating the question item the respondent is currently answering.
#'
#' @return A vector of values indicating the possible subsequent questions
#' 
#' @examples
#' \dontrun{
#'## Prior calculation using Cat object of the ltm model
#'## specifying different distributions
#'data(npi)
#'cat <- ltmCat(npi)
#'}
#' 
#' @author Haley Acevedo, Ryden Butler, Josh W. Cutler, Matt Malis, Jacob M. Montgomery,
#'  Tom Wilkinson, Erin Rossiter, Min Hee Seo, Alex Weil 
#'  
#' @note This function is to allow users to access the internal functions of the package. During item selection, all calculations are done in compiled C++ code.
#' 
#' @seealso \code{\link{selectItem}} for selection method information
#'
#' @export
lookAhead <- function(catObj, item) {
    .Call('catSurv_lookAhead', PACKAGE = 'catSurv', catObj, item)
}

#' Check if Stop and/or Override Rules are Met
#'
#' Evaluates the specified stopping and/or override rules to check if respondent should be asked further questions
#'
#' @param catObj  An object of class \code{Cat}
#'
#' @return This function returns a boolean, where TRUE indicates the the stopping rules are met (no further questions should be asked) and FALSE indicates the stoppings rules are not met (additional questions are needed)
#'
#' @details The stopping rule thresholds are stored in the following Cat object slots: lengthThreshold, seThreshold, infoThreshold, and gainThreshold.
#'   The override thresholds are stored in the following Cat object slots: lengthOverride, gainOverride. A value of NA indicates the rule should not be used.
#' 
#'   A return value of TRUE indicates that additional questions should be asked; FALSE indicates no additional questions should be asked.
#' 
#'   A user can specify any combination of stopping rules and/or overrides.  The function returns TRUE if all specified stopping rules are met
#'   and no specified overrides are met. The function returns FALSE if at least one specified stopping rule is not met, or if any specified override threshold is met.
#' 
#'   Stopping Rules:
#'
#'   lengthThreshold: Number of question's answered >= a
#'  
#'   seThreshold: \eqn{SE(\hat{\theta}) < a}
#'  
#'   infoThreshold: \deqn{FI < a \forall}{FI < a \forall} remaining items
#'
#'   gainThreshold: \deqn{SE(\hat{\theta}) - \sqrt{EPV} | < a \forall}{SE(\hat{\theta}) - \sqrt{EPV} | < a \forall} remaining items
#'
#'   Overrides:
#'
#'   lengthOverride: Number of question's answered < a
#'
#'   gainOverride: \deqn{|SE(\hat{\theta}) - \sqrt{EPV} | >= a \forall}{|SE(\hat{\theta}) - \sqrt{EPV} | >= a \forall} remaining items
#' 
#' 
#' @export
checkStopRules <- function(catObj) {
    .Call('catSurv_checkStopRules', PACKAGE = 'catSurv', catObj)
}

